<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--> <!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"><!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <title>C-Study Notes &#8211; Muyang Guo</title> <meta name="description" content="Muyang acquired M.S degree in Computational Science & Engineering, B.S and M.S degree in Mechanical Engineering from Georgia Tech."> <meta name="keywords" content="C, Embeded, C++"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="http://localhost:4000/assets/img/avatar.png"> <meta name="twitter:title" content="C-Study Notes"> <meta name="twitter:description" content="C-Study … keep updating"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="C-Study Notes"> <meta property="og:description" content="C-Study … keep updating"> <meta property="og:url" content="http://localhost:4000/C-study/"> <meta property="og:site_name" content="Muyang Guo"> <meta property="og:image" content="http://localhost:4000/assets/img/avatar.png"> <link rel="canonical" href="http://localhost:4000/C-study/"> <link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Muyang Guo Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css"> <!-- JS --> <script src="http://localhost:4000/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="http://localhost:4000/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4000/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4000/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4000/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png" /> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" /> <!-- Background Image --> <style type="text/css">body {background-image:url(http://localhost:4000/assets/img/background.jpeg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-157817052-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-157817052-1'); </script> <!-- google global ads --> <script data-ad-client="ca-pub-1032547897605308" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button id="navbutton" class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="http://localhost:4000/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="http://localhost:4000/assets/img/avatar.png" alt="Muyang Guo photo" class="author-photo"> <h4>Muyang Guo</h4> <p>Muyang acquired M.S degree in Computational Science & Engineering, B.S and M.S degree in Mechanical Engineering from Georgia Tech.</p> </li> <li><a href="http://localhost:4000/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="mailto:muyangguo@gmail.com" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-envelope-square"></i> Email</a> </li> <li> <a href="https://linkedin.com/in/muyang-guo-445a3465" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a> </li> <li> <a href="https://github.com/MUYANGGUO" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> <li> <a href="https://youtube.com/channel/UCmPARI6b-xWY4gSdo1XFoog" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-youtube"></i> Youtube</a> </li> </ul><!-- /.dl-submenu --> </li> <!-- <li> <a href="#">Tech Blogs</a> <ul class="dl-submenu"> --> <li><a href="http://localhost:4000/posts/">Tech Blogs</a></li> <!-- </ul> </li> --> <li><a href="http://localhost:4000/projects/" >Projects</a></li> <li><a href="http://localhost:4000/leetcode/">LeetCode Solutions</a></li> <li><a href="http://localhost:4000/tags/">Tags Archive</a></li> <li><script async src="https://cse.google.com/cse.js?cx=000703603923980589510:t0yhdcd_f-u"></script> <div class="gcse-search"></div> </li> </ul><!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <div class="sidenav"> <h1 > " MUYANG's SITE " </h1> <hr class="hr-line"> <h1 > " SEARCH " </h1> <h1 > <script async src="https://cse.google.com/cse.js?cx=000703603923980589510:t0yhdcd_f-u"></script> <div class="gcse-search"></div> </h1> <hr class="hr-line"> <h1 > " WEB STATS " </h1> <!-- statistics --> <h1 > <script type="text/javascript" src="//rf.revolvermaps.com/0/0/8.js?i=5i5a5rwv7vf&amp;m=0c&amp;c=ff007e&amp;cr1=fff600&amp;f=times_new_roman&amp;l=49&amp;bv=85&amp;cw=ffffff&amp;cb=000000" async="async"></script> </h1> <hr class="hr-line"> <h1 > " Appreciate support if you like " </h1> <img src="http://localhost:4000/assets/img/venmome.png" alt="" class="img-small-square"> <hr class="hr-line"> <div class="footer"> © 2020 muyangguo.xyz </div> </div> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>C-Study Notes</h1> <h4>01 Nov 2019</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~7 minutes </p><!-- /.entry-reading-time --> <a class="btn zoombtn" href="http://localhost:4000/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <h1 id="c-study"><a href="https://github.com/MUYANGGUO/C-study">C-study</a></h1> <p>Study C for embeded systems coding</p> <h2 id="include-headers">Include Headers</h2> <p>&lt;&gt; for standard libraries, “” for user defined.</p> <h2 id="complier-and-temps-files">Complier and temps files.</h2> <p>main.c –&gt;compiler–&gt; main.i, preprocessing stage, preprocess directives, main, indludes … all pre-processing directives will be resolved.</p> <p>main.i –&gt;complier–&gt;main.s, code generation stage, higher level language code statements will be converted into processor architectural level mnemonics.</p> <p>main.s –&gt;complier–&gt;main.o, assembly level mnemonics are converted into opcodes(machine codes for instructions)</p> <blockquote> <p>adding extra compile flag <code class="highlighter-rouge">-save-temps</code> can save the intermediate generated code in these stages.</p> </blockquote> <h2 id="escape-sequence">Escape sequence</h2> <p>E.g. <code class="highlighter-rouge">\n</code> for prinf(); is moving the cursor to next line, <code class="highlighter-rouge">\"</code> is double quote, apply <code class="highlighter-rouge">\</code> before the escape sequence can counter the effect of the escape.</p> <h2 id="format-specifier">Format specifier</h2> <p>%d: integer, %f: float, %c: character, %s: string, %u: unsigned integer, %ld: long integer <br /> %p: pointer, a memory address <code class="highlighter-rouge">printf("variable is stored in %p\n", &amp;myVariable);</code></p> <h2 id="data-types-in-c">Data types in C</h2> <h3 id="integer-data-types-integers">Integer data types: integers</h3> <p>Integer data types(for signed data): data could be negative</p> <ul> <li>char</li> <li>Short int, also referred by short, and “int” is assumed. short int == short</li> <li>int</li> <li>long int, also referred by long, and “int” is assumed. long int == long</li> <li>long long int, also referred by long long, and “int” is assumed, long long int == long long</li> </ul> <p>Integer data types(for unsigned data): data always be non-negative</p> <ul> <li>unsigned char</li> <li>unsigned short int</li> <li>unsigned int</li> <li>unsigned long int</li> <li>unsigned long long int</li> </ul> <h4 id="integer-data-types-storage-size-and-value-ranges">integer data types, storage size and value ranges</h4> <p><a href="https://www.tutorialspoint.com/cprogramming/c_data_types.htm">Table</a></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;limits.h&gt;
#include &lt;float.h&gt;

int main(int argc, char** argv) {

    printf("CHAR_BIT    :   %d\n", CHAR_BIT);
    printf("CHAR_MAX    :   %d\n", CHAR_MAX);
    printf("CHAR_MIN    :   %d\n", CHAR_MIN);
    printf("INT_MAX     :   %d\n", INT_MAX);
    printf("INT_MIN     :   %d\n", INT_MIN);
    printf("LONG_MAX    :   %ld\n", (long) LONG_MAX);
    printf("LONG_MIN    :   %ld\n", (long) LONG_MIN);
    printf("SCHAR_MAX   :   %d\n", SCHAR_MAX);
    printf("SCHAR_MIN   :   %d\n", SCHAR_MIN);
    printf("SHRT_MAX    :   %d\n", SHRT_MAX);
    printf("SHRT_MIN    :   %d\n", SHRT_MIN);
    printf("UCHAR_MAX   :   %d\n", UCHAR_MAX);
    printf("UINT_MAX    :   %u\n", (unsigned int) UINT_MAX);
    printf("ULONG_MAX   :   %lu\n", (unsigned long) ULONG_MAX);
    printf("USHRT_MAX   :   %d\n", (unsigned short) USHRT_MAX);

    return 0;
}
</code></pre></div></div> <p>meaning of the memory size (Bytes): (Depends on the complier how to identify the types and allocate the memory) (8bits is 1 Byte)</p> <p>The compiler (e.g.GCC) will generate the code to allocate 64 bits(8 bytes of memory) for each long long variable.</p> <p><strong>These data types will always be fixed size irrespective of compliers</strong>&lt;/br&gt; char (singed or unsigned) is always 1 byte.<br /> short (signed or unsigned) is always 2 bytes. <br /> longlong (signed or unsigned) is always 8 bytes. <br /></p> <ul> <li><strong><em>char</em></strong> It is an integer data type to store a single character (ASCII code) value or 1 byte of signed integer value (positive or negetive value), char variable consumes 1 byte of memory. It is the <strong><em>smallest</em></strong> integer data type of 1 byte.<br /> char range: -128 - 127, char data type will be used to store 1 byte of signed data. unsigned char range: 0 - 255, unsigned char will be used to store 1 byte of unsigned data.</li> </ul> <h3 id="floating-data-types-real-number">floating data types: real number</h3> <p><a href="https://www.tutorialspoint.com/cprogramming/c_data_types.htm">Table</a></p> <hr /> <h3 id="sizeof-operator">sizeof operator</h3> <p><strong>sizeof</strong> operator of C is used to find out the size of a variable. The output of the sizeof operator maybe different on different machines because it is complier dependent.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;stdio.h&gt;

int main()
{
    //sizeof() operator called as keyword, operand can be variable name or data type
    printf("Size of char data tyope = %d\n", sizeof(char));
    printf("Size of char data tyope = %d\n", sizeof(short));
    printf("Size of char data tyope = %d\n", sizeof(int));
    printf("Size of char data tyope = %d\n", sizeof(long));
    printf("Size of char data tyope = %d\n", sizeof(long long));

    return 0;
}

</code></pre></div></div> <hr /> <h2 id="variables">Variables</h2> <ul> <li> <p>local variable: <br /> ‘Local variable’ exists (memory claimed) for the time the function is executed. Once the function exits , local variable die.(memory reclaimed). They do not sit permanently on the data memory. <br /> can be seen as bounded within the scope of definition bracket <code class="highlighter-rouge">{}</code>. <br /> <strong><em>uninitialized local variable default value :</em></strong> unpredictable, can be some random values. dangerous! so make sure you need to declare it. <br /></p> </li> <li> <p>global variable: &lt;/br&gt; ‘Global variable’ exists on the memory permenantly. <br /> <strong><em>uninitialized global variable default value :</em></strong> 0. <br /></p> </li> </ul> <hr /> <h2 id="address-of-variables">Address of variables:</h2> <p>E.g. Use <code class="highlighter-rouge">&amp;myVariable</code>, <code class="highlighter-rouge">&amp;</code> ampersand, to give the memory location address of <code class="highlighter-rouge">myVaribale</code> variable.</p> <p>pointer type usually 8 bytes.</p> <p>we can use <strong>typeCasting</strong> to convert pointer type to the datatype we want.</p> <p>E.g.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;stdio.h&gt;
int main(){
    //define and declare char type a1 variable. 
    char a1 = 'A';

    //start a variable named addressOfa1, type is 8 byte unsigned long long int to match the pointer data type size, 

    unsigned long long int addressOfa1 = ( unsigned long long int ) &amp;a1;

    // ( unsigned long long int ) is typecasting, convert the output of &amp;a1 datatype to the unsigned long long int. 

    printf("address of variable a1 = %I64X\n", addressOfa1);
    //%I64,means integer 64 bits, X means hexagon. 

    return 0;
}
</code></pre></div></div> <h2 id="storage-classes">Storage Classes</h2> <h3 id="storage-classes-in-c-">storage classes in c :</h3> <ul> <li>static : restrict the visibility of the variable/functions only within the scope. (protect)</li> <li>extern : extend the visibility to other files/scope.</li> </ul> <h3 id="ascii-codes">ASCII codes</h3> <p>The American National Standards Institute (ANSI), which developed ANSI C, also developed the ASCII codes. ASCII stands for “American Standard Code for Information Interchange’. <br /> Encode 128 different characters. Refer to the ASCII table. (0-127)</p> <h2 id="typecasting">Typecasting:</h2> <p>Typecasting is a way of converting a variable or data from one data type to another data type.</p> <p>**Data will be truncated when higher data type is converted into lower. **</p> <ul> <li> <p>Implicit casting (Complier does this, assume casting)</p> </li> <li> <p>Explicit casting (Overwrite what complier does, programmer does this)</p> </li> </ul> <p>Warning may cause trouble, because they maybe related to implicit casting… which actually truncated information.</p> <hr /> <h2 id="embedded-microcontroller">Embedded Microcontroller:</h2> <p>For coding, all microcontroller needs to have a start file. (given in the STM32CubeIDE tho, may need to write yourself)</p> <p>Using printf outpus on ARM Cortex M3/M4/M7 or higher based MCUs. printf works over SWO pin (Serial Wire Output of SWD interface)</p> <p>[processor] —SWO pin — [debug module]</p> <h3 id="swd">SWD</h3> <p>SWD(Serial Wire Debug) is a two-wire protocol for accessing the ARM debug interface. It is part of the ARM Debug interface Specification v5 and is an alternative to JTAG.</p> <p>The physical layer of SWD consists of two lines:</p> <ul> <li>SWDIO: a bidirectional data line</li> <li>SWCLK: a clock driven by the host</li> </ul> <p>By using SWD interface, should be able to program MCUs internal flash, you can access memory regions, add breakpoints, stop/run CPU.</p> <p>The other good thing about SWD is you can use the serial wire viewer for your printf statements for debugging.</p> <h2 id="embeded-system-notes">Embeded system notes:</h2> <p>An embeded application never ends <br /> If the application has got nothing to do, it will put the processor to sleep or executes the infinite loop.</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for(;;);
</code></pre></div></div> <p>A statement like this in the main function is an implementatiion of an infinite loop that does nothing but keeps the processor busy.</p> <h3 id="what-is-microcontroller">What is Microcontroller?</h3> <p>MCU is a small computer system on a single chip, but its resources and capalibilities such as memory, speed, external interfaces are very much limited than of a desktop computer, because of MCU targets embeded applications.<br /></p> <p>A typical microcontroller includes a processor, volatile and non-volatile memories, inpuit/output(I/O) pins, peripherals, clock, bus interfaces on a single chip. <img src="https://raw.githubusercontent.com/MUYANGGUO/C-study/master/README_IMAGES/p1.png" alt="Anatomy of a Typical Small Microcontroller" /> <!-- <figure> <a href="https://github.com/MUYANGGUO/C-study/tree/master/README_IMAGES/p1.png"><img src="https://github.com/MUYANGGUO/C-study/tree/master/README_IMAGES/p1.png"></a> </figure> --></p> <p>CPU execute instructions, the instructions are from the program memory, usually non-volatile. It means once stored the programs into the program memory, cant erase it, or write programs, even plugged out the power, the program memory will not be corrupted. <br /></p> <p>How fast the cpu can decode the instructions depends on the clock speed. <br /></p> <p>Data memory: volatile, and it is used to store data of the program and also used as a scratchpad. Usually it is consumed during the run-time of the program.</p> <p>Code Memory (program memory) :</p> <p>The purpose of the code memory is to store instructions and constant data of the program, there are different types of code memory: <br /></p> <ul> <li>ROM (read only memory) <ul> <li>MPROM (mask programmable read only memory)</li> <li>EPROM (ultraviolet erasable programmable ROM)</li> <li>EEPROM (electrially erasable programmable ROM)</li> </ul> </li> <li>OTP (on time programmable)</li> <li>Flash (erasable, easy to use, dominant in most MCUs)</li> <li>FRAM (Ferroelectric Random Access Memory, costly but fast)</li> </ul> <h3 id="question">Question</h3> <p><strong>when doing embeded, downloaded the program to the code memory (non-volatile, flash), the initial data is with the program and stored there, how the data be used or later in data memory (volatile, SRAM as e.g.)?</strong></p> <p>To analyze this, we should analyze the ELF file, using the GNU tools, or check the .list file for <code class="highlighter-rouge">.data</code> <br /></p> <p>LMA: load memory address (source in FLASH)</p> <p>VMA: virtual memory address (destination in SRAM)</p> <p>By examining, we can observe that when loading the program, the source and destination address have been assigned, who did this? <!-- ![Reset of Processor](https://github.com/MUYANGGUO/C-study/tree/master/README_IMAGES/p2.png) --></p> <figure> <a href="https://raw.githubusercontent.com/MUYANGGUO/C-study/master/README_IMAGES/p2.png"><img src="https://raw.githubusercontent.com/MUYANGGUO/C-study/master/README_IMAGES/p2.png" /></a> </figure> <hr /> <p>Copyright 2019 Muyang Guo</p> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="http://localhost:4000/tags/#C" title="Pages tagged C" class="tag"><span class="term">C</span></a><a href="http://localhost:4000/tags/#Embeded" title="Pages tagged Embeded" class="tag"><span class="term">Embeded</span></a><a href="http://localhost:4000/tags/#C++" title="Pages tagged C++" class="tag"><span class="term">C++</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/C-study/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/C-study/" title="Share on Linkedin" class="tag"> <span class="term"><i class="fa fa-linkedin-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/C-study/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> <section id="disqus_thread" class="animated fadeInUp"></section><!-- /#disqus_thread --> </header> <!-- JS --> <script src="http://localhost:4000/assets/js/jquery-1.12.0.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.dlmenu.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.goup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.magnific-popup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.fitvid.min.js"></script> <script src="http://localhost:4000/assets/js/scripts.js"></script> <script type="text/javascript"> var disqus_shortname = 'muyangguo'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
