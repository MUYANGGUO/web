<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--> <!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"><!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <title>Use poisson distribution to generate random discrete events over a time for simulation &#8211; Muyang Guo</title> <meta name="description" content="Muyang acquired B.S and M.S degree in Mechanical Engineering from Georgia Tech and is currently pusuring another M.S degree in Computational Science & Engineering"> <meta name="keywords" content="Python, Modeling & Simulation"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="http://localhost:4000/assets/img/avatar.png"> <meta name="twitter:title" content="Use poisson distribution to generate random discrete events over a time for simulation"> <meta name="twitter:description" content="An example of how I use poisson distributed random variables to generate discrete events"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Use poisson distribution to generate random discrete events over a time for simulation"> <meta property="og:description" content="An example of how I use poisson distributed random variables to generate discrete events"> <meta property="og:url" content="http://localhost:4000/Poisson-Distribution/"> <meta property="og:site_name" content="Muyang Guo"> <meta property="og:image" content="http://localhost:4000/assets/img/avatar.png"> <link rel="canonical" href="http://localhost:4000/Poisson-Distribution/"> <link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Muyang Guo Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css"> <!-- JS --> <script src="http://localhost:4000/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="http://localhost:4000/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4000/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4000/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4000/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png" /> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" /> <!-- Background Image --> <style type="text/css">body {background-image:url(http://localhost:4000/assets/img/background.jpeg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-157817052-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-157817052-1'); </script> <!-- google global ads --> <script data-ad-client="ca-pub-1032547897605308" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button id="navbutton" class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="http://localhost:4000/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="http://localhost:4000/assets/img/avatar.png" alt="Muyang Guo photo" class="author-photo"> <h4>Muyang Guo</h4> <p>Muyang acquired B.S and M.S degree in Mechanical Engineering from Georgia Tech and is currently pusuring another M.S degree in Computational Science & Engineering</p> </li> <li><a href="http://localhost:4000/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="mailto:muyangguo@gmail.com" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-envelope-square"></i> Email</a> </li> <li> <a href="https://linkedin.com/in/muyang-guo-445a3465" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a> </li> <li> <a href="https://github.com/MUYANGGUO" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> </ul><!-- /.dl-submenu --> </li> <!-- <li> <a href="#">Tech Blogs</a> <ul class="dl-submenu"> --> <li><a href="http://localhost:4000/posts/">Tech Blogs</a></li> <!-- </ul> </li> --> <li><a href="http://localhost:4000/projects/" >Projects</a></li> <li><a href="http://localhost:4000/tags/">Tags Archive</a></li> <li><script async src="https://cse.google.com/cse.js?cx=000703603923980589510:t0yhdcd_f-u"></script> <div class="gcse-search"></div></li> </ul><!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <div class="sidenav"> <h1 > " MUYANG's SITE " </h1> <hr class="hr-line"> <h1 > " SEARCH " </h1> <h1 > <script async src="https://cse.google.com/cse.js?cx=000703603923980589510:t0yhdcd_f-u"></script> <div class="gcse-search"></div> </h1> <hr class="hr-line"> <h1 > " WEB STATS " </h1> <!-- statistics --> <h1 > <script type="text/javascript" src="//rf.revolvermaps.com/0/0/8.js?i=5i5a5rwv7vf&amp;m=0c&amp;c=ff007e&amp;cr1=fff600&amp;f=times_new_roman&amp;l=49&amp;bv=85&amp;cw=ffffff&amp;cb=000000" async="async"></script> </h1> <hr class="hr-line"> </div> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>Use poisson distribution to generate random discrete events over a time for simulation</h1> <h4>05 Feb 2020</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~3 minutes </p><!-- /.entry-reading-time --> <a class="btn zoombtn" href="http://localhost:4000/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <h3 id="poisson-distribution">Poisson distribution:</h3> <p>the probabily mass function of discrete random variable \(X\) having a poisson distribution:<br /> \(f(k;\lambda) = \Pr(X = k) = \frac{\lambda^{k}e^{-\lambda}}{k!}\)<br /> where \(e\) is Euler’s number, \(k = 0,1,2,...\) , \(\lambda &gt; 0\). and \(\lambda = E(X) = Var(X)\).</p> <h3 id="some-key-notes">Some key notes:</h3> <ol> <li>k is the number of occurence of events occured in an interval, k is 0,1,2…</li> <li>the events are all independent, the occurence of one event will not affect the probability of another event occur</li> <li>Two events will not occur at the same time.</li> </ol> <h3 id="understanding-implementation-in-discrete-events-simulation">Understanding implementation in Discrete Events Simulation:</h3> <p>For Discrete Events Simulations, as we would like to randomly generate discrete and independent events, poisson is a very good fit. <br /> For example, I want to simulate a car flow, to see at certain traffic flow rate (how many cars can pass in an unit time), how the traffic will be. Before we getting to any queue model or other simulation models, we need to fisrt generate some timestamps for each car’s arrival time. Poisson distribution can help on this step!<br /> We could derive the \(\lambda\) from this traffic flow rate. E.g. 500 car per hour. which is about 0.137 car per second. <br /> And poisson distribution will gave us the probability distribution of \(k = 0,1,2 ...\) events happening in each time interval that for this \(\lambda\). This is exactly what we want to generate the events happening.</p> <p>I write this function with <code class="highlighter-rouge">numpy</code> package for the implementation:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">rng_seed</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">n_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="mi">50000</span><span class="p">,</span> <span class="mi">5000000</span><span class="p">]</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#hr
</span>
<span class="k">class</span> <span class="nc">Scene</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">rng_seed</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">t</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">rng_seed</span> <span class="o">=</span> <span class="n">rng_seed</span>
    <span class="k">def</span> <span class="nf">poisson_generate_timestamps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">lamda</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="mf">60.0</span><span class="o">/</span><span class="mf">60.0</span> <span class="c1">#lambda per second
</span>            <span class="n">Time</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">T</span><span class="o">*</span><span class="mf">60.0</span><span class="o">*</span><span class="mf">60.0</span><span class="p">)</span> <span class="c1">#total seonds
</span>            <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rng_seed</span><span class="p">)</span><span class="c1"># initialize generator with seed
</span>            <span class="n">poisson</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">lamda</span><span class="p">,</span><span class="n">Time</span><span class="p">)</span><span class="c1"># generated the poisson events over the total time interval(s)
</span>            <span class="n">time_stamps</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">time_stamp</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">poisson</span><span class="p">:</span><span class="c1"># for each second, could have k = 0,1,2.... k from our generated poisson values
</span>                <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">event_time</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="c1">#if k not zero, k could be more than 1, we could generate uniform random number within 1s for all k
</span>                    <span class="k">for</span> <span class="n">t_s</span> <span class="ow">in</span> <span class="n">event_time</span><span class="p">:</span>
                        <span class="n">time_stamp</span><span class="o">=</span><span class="n">time_stamp</span><span class="o">+</span><span class="n">t_s</span>
                        <span class="n">time_stamps</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">time_stamp</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">time_stamp</span> <span class="o">=</span> <span class="n">time_stamp</span><span class="o">+</span><span class="mf">1.0</span><span class="c1">#if k is zero within 1 second, simply pass this and add 1 s to for time increase
</span>            <span class="n">np</span><span class="p">.</span><span class="n">sort</span><span class="p">(</span><span class="n">time_stamps</span><span class="p">)</span><span class="c1">#sort the timestamps
</span>            <span class="n">total_sim_event</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_stamps</span><span class="p">)</span>
            <span class="n">sim_mean</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">poisson</span><span class="p">)</span>
            <span class="n">sim_var</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">var</span><span class="p">(</span><span class="n">poisson</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="si">\</span><span class="se">n</span><span class="s">Based on input parameters [{} events , {} hr], expected rate is {:.3f} events/second, </span><span class="si">\</span><span class="se">n</span><span class="s">Sampled {} events based on poisson process within time {} hr,sample mean is {:.3f} events/second, sample var is {: .3f}'</span>\
                <span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">N</span><span class="p">,</span><span class="bp">self</span><span class="p">.</span><span class="n">T</span><span class="p">,</span><span class="n">lamda</span><span class="p">,</span><span class="n">total_sim_event</span><span class="p">,</span><span class="bp">self</span><span class="p">.</span><span class="n">T</span><span class="p">,</span><span class="n">sim_mean</span><span class="p">,</span><span class="n">sim_var</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">time_stamps</span><span class="p">,</span><span class="n">poisson</span>

<span class="k">def</span> <span class="nf">save_poisson_hist_plot</span><span class="p">(</span><span class="n">poisson</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"saving ... {} plot ... "</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span> 
    <span class="n">dirpath</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span>
    <span class="n">res_dir</span> <span class="o">=</span> <span class="n">results_dir</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="s">'outputs/'</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">res_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">res_dir</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'count'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'bins'</span><span class="p">)</span>
    <span class="n">bin_num</span> <span class="o">=</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">poisson</span><span class="p">)</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">poisson</span><span class="p">))</span><span class="o">*</span><span class="mi">4</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">poisson</span><span class="p">,</span><span class="n">bin_num</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s">'b'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">res_dir</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">'.png'</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="k">return</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n_list</span><span class="p">:</span>
    <span class="n">scene</span> <span class="o">=</span> <span class="n">Scene</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">timestamps</span><span class="p">,</span> <span class="n">poisson</span> <span class="o">=</span> <span class="n">scene</span><span class="p">.</span><span class="n">poisson_generate_timestamps</span><span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="s">'_plot'</span>
    <span class="n">save_poisson_hist_plot</span><span class="p">(</span><span class="n">poisson</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code></pre></figure> <p>And the outputs are:<br /></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Based on input parameters [500 events , 1 hr], expected rate is 0.139 events/second, 
Sampled 510 events based on poisson process within time 1 hr,sample mean is 0.142 events/second, sample var is  0.142
saving ... 500_plot plot ... 

Based on input parameters [50000 events , 1 hr], expected rate is 13.889 events/second, 
Sampled 50101 events based on poisson process within time 1 hr,sample mean is 13.917 events/second, sample var is  13.500
saving ... 50000_plot plot ... 

Based on input parameters [5000000 events , 1 hr], expected rate is 1388.889 events/second, 
Sampled 5000949 events based on poisson process within time 1 hr,sample mean is 1389.152 events/second, sample var is  1337.519
saving ... 5000000_plot plot ... 
</code></pre></div></div> <figure> <a href="https://raw.githubusercontent.com/MUYANGGUO/Simulation-DES/master/README_FILES/500_plot.png"><img src="https://raw.githubusercontent.com/MUYANGGUO/Simulation-DES/master/README_FILES/500_plot.png" /></a> </figure> <figure> <a href="https://raw.githubusercontent.com/MUYANGGUO/Simulation-DES/master/README_FILES/50000_plot.png"><img src="https://raw.githubusercontent.com/MUYANGGUO/Simulation-DES/master/README_FILES/50000_plot.png" /></a> </figure> <figure> <a href="https://raw.githubusercontent.com/MUYANGGUO/Simulation-DES/master/README_FILES/5000000_plot.png"><img src="https://raw.githubusercontent.com/MUYANGGUO/Simulation-DES/master/README_FILES/5000000_plot.png" /></a> </figure> <p>As can be seen from these histograms, as N increases,while t stays the same, thus \(\lambda\) is increasing, the distribution is more close to normal, but probability of K is actually lower (compare the count over the N). Just like the probabilily distribution cited from the wikipedia page here:</p> <figure> <a href="https://upload.wikimedia.org/wikipedia/commons/1/16/Poisson_pmf.svg"><img src="https://upload.wikimedia.org/wikipedia/commons/1/16/Poisson_pmf.svg" /></a> </figure> <p>And our program validated that the generated events mean and variance are very close to our expectation \(\lambda\).</p> <p>In this way we can generate random discrete events using poisson distribution.</p> <hr /> <p>Copyright 2019 Muyang Guo</p> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="http://localhost:4000/tags/#Python" title="Pages tagged Python" class="tag"><span class="term">Python</span></a><a href="http://localhost:4000/tags/#Modeling & Simulation" title="Pages tagged Modeling & Simulation" class="tag"><span class="term">Modeling & Simulation</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/Poisson-Distribution/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/Poisson-Distribution/" title="Share on Linkedin" class="tag"> <span class="term"><i class="fa fa-linkedin-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/Poisson-Distribution/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> <section id="disqus_thread" class="animated fadeInUp"></section><!-- /#disqus_thread --> </header> <!-- JS --> <script src="http://localhost:4000/assets/js/jquery-1.12.0.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.dlmenu.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.goup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.magnific-popup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.fitvid.min.js"></script> <script src="http://localhost:4000/assets/js/scripts.js"></script> <script type="text/javascript"> var disqus_shortname = 'muyangguo'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
